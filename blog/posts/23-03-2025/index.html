
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://atlansec.es/blog/posts/23-03-2025/">
      
      
      
      
      <link rel="icon" href="../../../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.4">
    
    
      
        <title>Server-Side Request Forgery: The Backdoor That Can Take Down Your Infrastructure - Atlansec</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/main.8608ea7d.min.css">
      
        
        <link rel="stylesheet" href="../../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../../stylesheets/extra.css">
    
    <script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
      
        <meta  property="og:type"  content="website" >
      
        <meta  property="og:title"  content="Server-Side Request Forgery: The Backdoor That Can Take Down Your Infrastructure - Atlansec" >
      
        <meta  property="og:description"  content="None" >
      
        <meta  property="og:image"  content="https://atlansec.es/assets/images/social/blog/posts/23-03-2025.png" >
      
        <meta  property="og:image:type"  content="image/png" >
      
        <meta  property="og:image:width"  content="1200" >
      
        <meta  property="og:image:height"  content="630" >
      
        <meta  property="og:url"  content="https://atlansec.es/blog/posts/23-03-2025/" >
      
        <meta  name="twitter:card"  content="summary_large_image" >
      
        <meta  name="twitter:title"  content="Server-Side Request Forgery: The Backdoor That Can Take Down Your Infrastructure - Atlansec" >
      
        <meta  name="twitter:description"  content="None" >
      
        <meta  name="twitter:image"  content="https://atlansec.es/assets/images/social/blog/posts/23-03-2025.png" >
      
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="white" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#server-side-request-forgery-the-backdoor-that-can-take-down-your-infrastructure" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      <!--
  Copyright (c) 2016-2024 Martin Donath <martin.donath@squidfunk.com>

  Permission is hereby granted, free of charge, to any person obtaining a copy
  of this software and associated documentation files (the "Software"), to
  deal in the Software without restriction, including without limitation the
  rights to use, copy, modify, merge, publish, distribute, sublicense, and/or
  sell copies of the Software, and to permit persons to whom the Software is
  furnished to do so, subject to the following conditions:

  The above copyright notice and this permission notice shall be included in
  all copies or substantial portions of the Software.

  THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
  IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
  FITNESS FOR A PARTICULAR PURPOSE AND NON-INFRINGEMENT. IN NO EVENT SHALL THE
  AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
  LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING
  FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS
  IN THE SOFTWARE.
-->

<!-- Determine classes -->
 

<style>
  .md-header {
    box-shadow: none;
  }

  .md-post__back {
    border-bottom: none !important;
  }
</style>

<!-- Header -->
<header class="md-header" data-md-component="header" style="width: 100%">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <!-- Button to open drawer -->
    <label class="md-header__button md-icon" for="__drawer">
       <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>

    <!-- Link to home -->
    <a
      href="../../.."
      title="Atlansec"
      class="md-header__button md-logo"
      aria-label="Atlansec"
      data-md-component="logo"
    >
      
  <img src="../../../../assets/images/logo.png" alt="logo">

    </a>

    <!-- Color palette toggle -->
      

    <!-- User preference: color palette -->
    

    <!-- Site language selector -->
     <div class="md-header__option">
  <div class="md-select">
    
    <button class="md-header__button md-icon" aria-label="Select language">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m12.87 15.07-2.54-2.51.03-.03A17.5 17.5 0 0 0 14.07 6H17V4h-7V2H8v2H1v2h11.17C11.5 7.92 10.44 9.75 9 11.35 8.07 10.32 7.3 9.19 6.69 8h-2c.73 1.63 1.73 3.17 2.98 4.56l-5.09 5.02L4 19l5-5 3.11 3.11zM18.5 10h-2L12 22h2l1.12-3h4.75L21 22h2zm-2.62 7 1.62-4.33L19.12 17z"/></svg>
    </button>
    <div class="md-select__inner">
      <ul class="md-select__list">
        
          <li class="md-select__item">
            <a href="./" hreflang="en" class="md-select__link">
              English
            </a>
          </li>
        
          <li class="md-select__item">
            <a href="../../../es/blog/posts/23-03-2025/" hreflang="es" class="md-select__link">
              Spanish
            </a>
          </li>
        
      </ul>
    </div>
  </div>
</div>  
    <style>
      .md-header__inner,
      .md-grid {
        justify-content: space-between;
      }
      @media screen and (max-width: 1219px) {
        .md-search {
          position: absolute;
          right: 0;
        }
      }
    </style>
    <!-- Button to open search modal -->
    
    <label class="md-header__button md-icon" for="__search">
       <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
    </label>

    <!-- Search interface -->
    <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
          <a href="javascript:void(0)" class="md-search__icon md-icon" title="Share" aria-label="Share" data-clipboard data-clipboard-text="" data-md-component="search-share" tabindex="-1">
            
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7s-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91s2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08"/></svg>
          </a>
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div> 

    <!-- Repository information -->
     
  </nav>

  <!-- Navigation tabs (sticky) -->
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../../.." class="md-tabs__link">
        
  
    
  
  Home

      </a>
    </li>
  

      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../../../services/" class="md-tabs__link">
        
  
    
  
  Services

      </a>
    </li>
  

      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../../" class="md-tabs__link">
        
  
    
  
  Blog

      </a>
    </li>
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../.." title="Atlansec" class="md-nav__button md-logo" aria-label="Atlansec" data-md-component="logo">
      
  <img src="../../../../assets/images/logo.png" alt="logo">

    </a>
    Atlansec
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../.." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Home
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../services/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Services
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Blog
    
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#what-is-an-ssrf-vulnerability" class="md-nav__link">
    <span class="md-ellipsis">
      What is an SSRF Vulnerability?
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#impact-of-ssrf-attacks" class="md-nav__link">
    <span class="md-ellipsis">
      Impact of SSRF Attacks
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#types-of-server-side-request-forgery" class="md-nav__link">
    <span class="md-ellipsis">
      Types of Server-Side Request Forgery
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Types of Server-Side Request Forgery">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#standard-ssrf" class="md-nav__link">
    <span class="md-ellipsis">
      Standard SSRF
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Standard SSRF">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#exploitation-methodology" class="md-nav__link">
    <span class="md-ellipsis">
      Exploitation Methodology
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#exploitation-example-to-access-amazon-ec2-metadata" class="md-nav__link">
    <span class="md-ellipsis">
      Exploitation Example to Access Amazon EC2 Metadata
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#exploitation-example-to-read-local-files" class="md-nav__link">
    <span class="md-ellipsis">
      Exploitation Example to Read Local Files:
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#blind-ssrf" class="md-nav__link">
    <span class="md-ellipsis">
      Blind SSRF
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Blind SSRF">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#exploitation-methodology_1" class="md-nav__link">
    <span class="md-ellipsis">
      Exploitation Methodology
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  <nav class="md-tags" >
    
      
      
      
        <span class="md-tag">Cybersecurity</span>
      
    
      
      
      
        <span class="md-tag">Pentesting</span>
      
    
      
      
      
        <span class="md-tag">SSRF</span>
      
    
      
      
      
        <span class="md-tag">Vulnerabilities</span>
      
    
      
      
      
        <span class="md-tag">Web Security</span>
      
    
  </nav>



<h1 id="server-side-request-forgery-the-backdoor-that-can-take-down-your-infrastructure">Server-Side Request Forgery: The Backdoor That Can Take Down Your Infrastructure</h1>
<p>In the realm of web security, <strong>Server-Side Request Forgery (SSRF)</strong> vulnerabilities stand out as one of the most critical and underestimated threats. They allow attackers to manipulate servers to make unauthorized HTTP requests to internal systems, compromising everything from APIs and cloud services to infrastructures protected by firewalls.</p>
<p>This attack technique, often overlooked, can turn a seemingly secure server into an entry point for cybercriminals, enabling them to access internal resources, steal sensitive data, and even launch attacks against third parties.</p>
<p>The result? Data theft, access to internal services, remote code execution, and ultimately, reputational damage, regulatory fines for non-compliance with laws like GDPR, and significant financial losses. A successful SSRF attack can cripple critical operations and erode customer trust.</p>
<!-- more -->

<h2 id="what-is-an-ssrf-vulnerability">What is an SSRF Vulnerability?</h2>
<p>Server-Side Request Forgery (SSRF) vulnerabilities occur when an attacker can manipulate a server into making unauthorized requests. Imagine a web server acting as a messenger that normally delivers messages (requests) only to authorized recipients. Exploiting an SSRF attack would be equivalent to a stranger forcing the messenger to send letters to any recipient without filtering, bypassing customs, and using an official sender.</p>
<p>To see a more concrete case, consider a shopping application that checks product stock through requests to a REST API. The application passes the URL to the API endpoint via an HTTP request. An attacker who notices this could modify this URL to access other internal API endpoints, potentially retrieving unauthorized information such as other users' data.</p>
<p>Additionally, SSRF attacks are not limited to the HTTP protocol. In some cases, an attacker could attempt to use other URI schemes, such as <code>file://</code> to access local files on the server, <code>smb://</code> to force authentication and obtain an NTLM hash, or other diverse protocols.</p>
<h2 id="impact-of-ssrf-attacks">Impact of SSRF Attacks</h2>
<p>Generally, an SSRF attack can result in unauthorized access to internal resources. In some situations, the SSRF vulnerability could allow an attacker to execute arbitrary commands through a chain of vulnerabilities.</p>
<p>When an SSRF can be used to establish connections with third-party external systems, an attacker can leverage it for spoofing attacks. This means that attacks will appear to originate from the organization hosting the vulnerable application. For example, an attacker could use an SSRF-vulnerable server to scan ports on another company’s internal network or even launch a denial-of-service (DoS) attack against an external service, making it seem like the offensive originates from the compromised organization.</p>
<p>Another possible exploitation scenario is internal network (intranet) reconnaissance, where an attacker can leverage SSRF to send requests to internal addresses through the affected server. This would allow them to identify open ports, map internal services, and gather sensitive information about the network infrastructure. The severity of the attack increases if the compromised server has privileged access to internal resources that would normally be protected from external access.</p>
<h2 id="types-of-server-side-request-forgery">Types of Server-Side Request Forgery</h2>
<p>There are two main types of Server-Side Request Forgery (SSRF) attacks:</p>
<ul>
<li><strong>Standard SSRF</strong>: In this type of attack, the server's response is directly shown to the attacker. The server fetches the attacker-supplied URL and sends the content (or part of it) back in the response.</li>
<li><strong>Blind SSRF</strong>: In this case, the response is not sent back to the attacker. The attacker must devise ways to confirm and exploit the vulnerability without seeing the server’s response directly.</li>
</ul>
<p>Next, we will examine the characteristics and exploitation methods of each type of SSRF, along with possible approaches for detecting and mitigating these vulnerabilities.</p>
<h3 id="standard-ssrf"><strong>Standard SSRF</strong></h3>
<p>The standard SSRF attack is the most direct form of this attack. In this scenario, the attacker can directly observe the server's response to the manipulated request, allowing them to collect detailed information about the internal network, identify accessible services, and retrieve potentially sensitive data.</p>
<h4 id="exploitation-methodology">Exploitation Methodology</h4>
<p>Exploiting this type of SSRF follows three phases:</p>
<ol>
<li><strong>Injection</strong>: The attacker injects a malicious URL into an application input field.</li>
<li><strong>Request</strong>: The server, without validating the URL, makes a request to the resource specified by the attacker.</li>
<li><strong>Disclosure</strong>: The server’s response is returned to the attacker, allowing them to access internal information.</li>
</ol>
<p>In the following example, we have a web application that allows querying the stock of the products it offers. To better visualize the requests, we will use an application proxy like BurpSuite, so we can see the request made when querying the product stock:</p>
<div class="language-http highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">POST</span> <span class="nn">/product/stock</span> <span class="kr">HTTP</span><span class="o">/</span><span class="m">1.0</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="na">Content-Type</span><span class="o">:</span> <span class="l">application/x-www-form-urlencoded</span>
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="na">Content-Length</span><span class="o">:</span> <span class="l">118</span>
</span><span id="__span-0-4"><a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a>
</span><span id="__span-0-5"><a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="nt">stockApi</span><span class="o">=</span><span class="s">stockApi</span><span class="o">=</span><span class="s">http://internal-stock-api/check?productId</span><span class="o">=</span><span class="s">123</span>
</span></code></pre></div>
<p>This request causes the client to receive the stock of the product indicated by the <code>productId</code>. However, an attacker could modify the request to the specified URL, such as:</p>
<div class="language-http highlight"><pre><span></span><code><span id="__span-1-1"><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a><span class="nf">POST</span> <span class="nn">/product/stock</span> <span class="kr">HTTP</span><span class="o">/</span><span class="m">1.0</span>
</span><span id="__span-1-2"><a id="__codelineno-1-2" name="__codelineno-1-2" href="#__codelineno-1-2"></a><span class="na">Content-Type</span><span class="o">:</span> <span class="l">application/x-www-form-urlencoded</span>
</span><span id="__span-1-3"><a id="__codelineno-1-3" name="__codelineno-1-3" href="#__codelineno-1-3"></a><span class="na">Content-Length</span><span class="o">:</span> <span class="l">118</span>
</span><span id="__span-1-4"><a id="__codelineno-1-4" name="__codelineno-1-4" href="#__codelineno-1-4"></a>
</span><span id="__span-1-5"><a id="__codelineno-1-5" name="__codelineno-1-5" href="#__codelineno-1-5"></a><span class="nt">stockApi</span><span class="o">=</span><span class="s">http://localhost/admin</span>
</span></code></pre></div>
<p>By sending this request, if the <code>/admin</code> directory exists on the attacked machine and is processed without further validation, the attacker could gain access to the internal admin panel.</p>
<h4 id="exploitation-example-to-access-amazon-ec2-metadata">Exploitation Example to Access Amazon EC2 Metadata</h4>
<p>A common case of SSRF exploitation is when the attacker accesses internal metadata of an EC2 instance on AWS:</p>
<p><div class="language-http highlight"><pre><span></span><code><span id="__span-2-1"><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a><span class="nf">POST</span> <span class="nn">/product/stock</span> <span class="kr">HTTP</span><span class="o">/</span><span class="m">1.0</span>
</span><span id="__span-2-2"><a id="__codelineno-2-2" name="__codelineno-2-2" href="#__codelineno-2-2"></a><span class="na">Content-Type</span><span class="o">:</span> <span class="l">application/x-www-form-urlencoded</span>
</span><span id="__span-2-3"><a id="__codelineno-2-3" name="__codelineno-2-3" href="#__codelineno-2-3"></a><span class="na">Content-Length</span><span class="o">:</span> <span class="l">118</span>
</span><span id="__span-2-4"><a id="__codelineno-2-4" name="__codelineno-2-4" href="#__codelineno-2-4"></a>
</span><span id="__span-2-5"><a id="__codelineno-2-5" name="__codelineno-2-5" href="#__codelineno-2-5"></a><span class="nt">stockApi</span><span class="o">=</span><span class="s">http://169.254.169.254/latest/meta-data/</span>
</span></code></pre></div>
Accessing this API could reveal sensitive information like access keys, IAM roles, or other sensitive data.</p>
<p>Specific countermeasures can be found in the <a href="https://aws.amazon.com/blogs/security/defense-in-depth-open-firewalls-reverse-proxies-ssrf-vulnerabilities-ec2-instance-metadata-service/" target="_blank">AWS documentation</a>.</p>
<h4 id="exploitation-example-to-read-local-files">Exploitation Example to Read Local Files:</h4>
<p>If the application allows the use of the file:// scheme, an attacker could attempt to read system files as follows:</p>
<div class="language-http highlight"><pre><span></span><code><span id="__span-3-1"><a id="__codelineno-3-1" name="__codelineno-3-1" href="#__codelineno-3-1"></a><span class="nf">POST</span> <span class="nn">/product/stock</span> <span class="kr">HTTP</span><span class="o">/</span><span class="m">1.0</span>
</span><span id="__span-3-2"><a id="__codelineno-3-2" name="__codelineno-3-2" href="#__codelineno-3-2"></a><span class="na">Content-Type</span><span class="o">:</span> <span class="l">application/x-www-form-urlencoded</span>
</span><span id="__span-3-3"><a id="__codelineno-3-3" name="__codelineno-3-3" href="#__codelineno-3-3"></a><span class="na">Content-Length</span><span class="o">:</span> <span class="l">118</span>
</span><span id="__span-3-4"><a id="__codelineno-3-4" name="__codelineno-3-4" href="#__codelineno-3-4"></a>
</span><span id="__span-3-5"><a id="__codelineno-3-5" name="__codelineno-3-5" href="#__codelineno-3-5"></a><span class="nt">stockApi</span><span class="o">=</span><span class="s">file:///etc/shadow</span>
</span></code></pre></div>
<h3 id="blind-ssrf"><strong>Blind SSRF</strong></h3>
<p>Blind SSRF attacks are more challenging since the server does not return the response directly to the attacker. In this type of attack, the attacker must infer the success of their intrusion through observable changes in application behavior or by interacting with an external server.</p>
<h4 id="exploitation-methodology_1">Exploitation Methodology</h4>
<p>Imagine a web application that allows users to upload profile pictures. The application verifies that the image is valid by making a request to the provided URL but does not display the result of this verification to the user.</p>
<p>A rudimentary implementation might look like this:</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-4-1"><a id="__codelineno-4-1" name="__codelineno-4-1" href="#__codelineno-4-1"></a><span class="kn">import</span> <span class="nn">requests</span>
</span><span id="__span-4-2"><a id="__codelineno-4-2" name="__codelineno-4-2" href="#__codelineno-4-2"></a><span class="k">def</span> <span class="nf">verify_image</span><span class="p">(</span><span class="n">url</span><span class="p">):</span>
</span><span id="__span-4-3"><a id="__codelineno-4-3" name="__codelineno-4-3" href="#__codelineno-4-3"></a>  <span class="k">try</span><span class="p">:</span>
</span><span id="__span-4-4"><a id="__codelineno-4-4" name="__codelineno-4-4" href="#__codelineno-4-4"></a>    <span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
</span><span id="__span-4-5"><a id="__codelineno-4-5" name="__codelineno-4-5" href="#__codelineno-4-5"></a>    <span class="k">if</span> <span class="n">response</span><span class="o">.</span><span class="n">headers</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;content-type&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;image/&#39;</span><span class="p">):</span>
</span><span id="__span-4-6"><a id="__codelineno-4-6" name="__codelineno-4-6" href="#__codelineno-4-6"></a>      <span class="k">return</span> <span class="kc">True</span>
</span><span id="__span-4-7"><a id="__codelineno-4-7" name="__codelineno-4-7" href="#__codelineno-4-7"></a>  <span class="k">except</span><span class="p">:</span>
</span><span id="__span-4-8"><a id="__codelineno-4-8" name="__codelineno-4-8" href="#__codelineno-4-8"></a>    <span class="k">pass</span>
</span><span id="__span-4-9"><a id="__codelineno-4-9" name="__codelineno-4-9" href="#__codelineno-4-9"></a>    <span class="k">return</span> <span class="kc">False</span>
</span><span id="__span-4-10"><a id="__codelineno-4-10" name="__codelineno-4-10" href="#__codelineno-4-10"></a>
</span><span id="__span-4-11"><a id="__codelineno-4-11" name="__codelineno-4-11" href="#__codelineno-4-11"></a>  <span class="n">user_provided_url</span> <span class="o">=</span> <span class="s2">&quot;https://example.com/image.jpg&quot;</span>
</span><span id="__span-4-12"><a id="__codelineno-4-12" name="__codelineno-4-12" href="#__codelineno-4-12"></a>  <span class="k">if</span> <span class="n">verify_image</span><span class="p">(</span><span class="n">user_provided_url</span><span class="p">):</span>
</span><span id="__span-4-13"><a id="__codelineno-4-13" name="__codelineno-4-13" href="#__codelineno-4-13"></a>    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Valid image&quot;</span><span class="p">)</span>
</span><span id="__span-4-14"><a id="__codelineno-4-14" name="__codelineno-4-14" href="#__codelineno-4-14"></a>  <span class="k">else</span><span class="p">:</span>
</span><span id="__span-4-15"><a id="__codelineno-4-15" name="__codelineno-4-15" href="#__codelineno-4-15"></a>    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Rejected URL&quot;</span><span class="p">)</span>
</span></code></pre></div>
<p>In this case, the server receives a URL, which in this case is <code>https://example.com/image.jpg</code>, and then makes an HTTP request to that URL to check if it contains an image. Finally, if the provided URL returns a resource with <strong>Content-Type: image/*</strong>, it will be considered valid.</p>
<p>The problem lies in the fact that the server blindly trusts URLs provided by users, allowing arbitrary <em>HTTP</em> requests to be made.</p>
<p>If an attacker supplies a URL they control or one that points to an internal resource of the server, such as <code>http://internal-server/sensitive-data</code>, the attacker will not directly see the server's response, but they can deduce whether the request was successful by observing certain behaviors:</p>
<ul>
<li><strong>Response time</strong>: An internal resource that takes longer to respond might indicate that the server accessed the resource.</li>
<li><strong>Error messages</strong>: Differences in the errors returned by the server can confirm the existence of the resource.</li>
</ul>
<p>To check if the request is being made to the provided URL, <strong>out-of-band (OOB)</strong> techniques are used, such as monitoring DNS or HTTP requests to domains controlled by the attacker. For example, it could be the following URL <code>http://internal-server.sensitive-data.attacker-domain.com</code>. Here, <code>attacker-domain</code> is a domain controlled by the attacker. If the vulnerable server processes this URL, it will try to resolve the domain and make an HTTP request to it. This allows the attacker to detect the activity by monitoring their own DNS or web server. This functionality is integrated through the Collaborator in the professional version of BurpSuite.</p>
<h1 id="how-to-prevent-ssrf-attacks">How to Prevent SSRF Attacks</h1>
<p>As we have seen earlier, SSRF attacks are particularly dangerous as they facilitate the exploitation of internal resources. To protect against this type of vulnerability, it's crucial to implement a combination of robust security measures. Below are the most effective strategies:</p>
<h3 id="strict-input-validation"><strong>Strict Input Validation</strong></h3>
<p>To protect against an SSRF attack, we can use the following:</p>
<ul>
<li><strong>Whitelists</strong>: We can allow the server to access specific, trusted URLs for the proper functioning of the application. Instead of allowing any URL, define a whitelist of domains and paths that the server is permitted to access. Any request that does not match this whitelist should be rejected. Example: <code>allowed = ["api.example.com/products", "images.example.com"]</code>.</li>
<li><strong>Blocking Internal Addresses</strong>: We can block requests to internal URLs to prevent access to internal server resources (e.g., <code>localhost</code> or any IP in the range <code>192.168.x.x</code>). Configure the server to reject any request to private IP addresses (10.0.0.0/8, 172.16.0.0/12, 192.168.0.0/16) and to <code>localhost</code> (127.0.0.1). This prevents unauthorized access to internal network resources, preventing an attacker from manipulating the server to access services or data that should be protected.</li>
<li><strong>Restrict Protocols</strong>: We can block protocols such as <strong>smb://</strong>, <strong>file://</strong>, and others. Limiting protocols to HTTP(S) reduces the attack surface, preventing the use of other potentially insecure protocols to access internal or external resources.</li>
</ul>
<h3 id="use-of-web-application-firewalls-wafs"><strong>Use of Web Application Firewalls (WAFs)</strong></h3>
<p>We can configure a WAF with specific rules to help detect and block suspicious patterns related to SSRF. WAFs can act as an additional layer of defense by monitoring and filtering outgoing traffic from the server.</p>
<h3 id="network-segmentation"><strong>Network Segmentation</strong></h3>
<p>We can divide the network into segments and limit access between them. For example, if the web server should not have direct access to the database because it uses an API, then the ability to send traffic directly to the database server should be restricted. Generally, the host should not be able to access more internal services than those strictly necessary for its operation, minimizing the attack surface. This approach should be adapted to the specific situation of each service.</p>
<h3 id="implement-monitoring"><strong>Implement Monitoring</strong></h3>
<p>Although blind SSRF does not show responses directly to the attacker, out-of-band techniques leave traces that can help detect malicious attempts. To detect these techniques, it is crucial to configure monitoring for DNS requests made by application servers to identify unexpected requests to external domains.</p>
<h3 id="periodic-security-testing"><strong>Periodic Security Testing</strong></h3>
<p>Conduct periodic security audits to protect your web applications against this and other threats.</p>
<h2 id="conclusion">Conclusion</h2>
<p>Preventing SSRF attacks requires a layered security approach, combining input validation, the use of WAFs, regular updates, network segmentation, and security testing. By implementing these measures, we can significantly reduce the risk of our infrastructure being compromised by this vulnerability. Remember, security is an ongoing process, and it is important to stay updated on the latest vulnerabilities and attack techniques.</p>
<p>Stay safe. Stay smart. Stay secure.</p>
<hr />







  
  






                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <style>
    .footer-bottom {
        padding-top: 1rem;
        padding-bottom: 1rem;
        text-align: center;
        font-size: 0.875rem;
        @media screen and (max-width: 991px) {
        font-size: 2vw;
            
        }
    }
</style>


<footer class="md-footer">
    <div class="footer-bottom">
        <p>&copy; 2025 Atlansec. All rights reserved.</p>
    </div>
    </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "../../..", "features": ["hide_title", "navigation.indexes", "navigation.tabs", "content.code.copy", "i18n", "search.share"], "search": "../../../assets/javascripts/workers/search.f8cc74c7.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../../../assets/javascripts/bundle.f1b6f286.min.js"></script>
      
        <script src="../../../javascripts/extra.js"></script>
      
    
  </body>
</html>