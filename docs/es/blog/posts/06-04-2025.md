---
title: ""
summary: ""
date: 2025-04-06
tags:
  - Seguridad Web
  - Path Traversal
  - Local File Inclusion
lang: es
---

# Title



<!-- more -->

# ¿Qué es Local File Inclusion (LFI)?
La vulnerabilidad de **Local File Inclusion** ocurre cuando el servidor incluye archivos locales basándose en entradas proporcionadas por el usuario. Esto puede llevar a la ejecución de código malicioso o la exposición de información confidencial.

## Impacto de las LFI

...


### LFI Básico
Como hemos comentado en la introducción, este tipo de vulnerabilidades se aprovechan de que el input del usuario no está sanitizado correctamente y por ende, el atacante puede realizar una serie de modificaciones que pueden alterar el funcionamiento de la aplicación web.

Imaginémonos que estamos ante una aplicación web desarrollada en *PHP* la cual contiene la siguiente línea de código:

```php
<?php
  $archivo = $_GET['archivo'];
  if (isset($archivo)) {
      include($archivo);
  }
?>
```
<figure markdown="span">
    ![LFI básico](../../assets/posts/2025/04/06/LFIbasico.png)
  <figcaption>Página web vulnerable a LFI básico</figcaption>
</figure>

Como vemos, el input del campo `archivo` no está sanitizado, por tanto, el atacante podría realizar insertar cualquier cosa en dicho campo, quedando la solicitud:
```url
http://dominio.com/pruebas/index.php?archivo=hola.php
```
<figure markdown="span">
    ![LFI básico](../../assets/posts/2025/04/06/LFIbasico2.png)
  <figcaption>Resultado de aplicar LFI básico</figcaption>
</figure>

Como podemos comprobar, a partir del parámetro no sanitizado contenido en la URL hemos podido leer un archivo contenido en el servidor que a priori es oculto para nosotros ya que no sabíamos que existía.

### Path Traversal (o Directory Traversal)
El ataque de Path Traversal ocurre cuando un atacante manipula las rutas de archivo para acceder a recursos fuera del directorio permitido. Esto se logra utilizando secuencias como `../` para navegar hacia directorios superiores.

Como vimos anteriormente, en aplicaciones desarrolladas con *PHP* es muy común encontrarnos con la siguiente línea de código:

```php
<?php
  $archivo = $_GET['archivo'];
  if (isset($archivo)) {
      include($archivo);
  }
?>
```

En el ejemplo anterior vimos que podíamos acceder al contenido de un fichero que se encontraba en el mismo directorio que el `index.php`, pero ¿podríamos intentar acceder a otros ficheros contenido en directorios superiores? La respuesta corta es **si**, pero supone un poco más de habilidad.

Un target muy común es leer archivos sensibles que contienen información ya sea acerca del sistema, o bien que contengan información sobre los usuarios del sistema, un ejemplo podría ser el siguiente: 
```url
https://ejemplo.com/index.php?parametro=../../../../../../etc/passwd
```




Por tanto, al igual que sucede en la vulnerabilidad **Path Traversal**, si el input de dicho parámetro no está sanitizado correctamente, el atacante podría realizar una modificación en la propia URL, quedando:
```url
https://ejemplo.com/index.php?parametro=../../../../../../etc/passwd
```
Esto permitiría leer el archivo `/etc/passwd`. Además, esto no solo podría quedar así, si no que el atacante podría escalarlo tanto a **RCE** (Ejecución Remota de Comandos) o **LogPoisoning** (Evenenamiento de archivos de log del servidor).




[Vulnerabilidades LFI](https://exploit-notes.hdks.org/exploit/web/security-risk/file-inclusion/){:target="_blank"}

