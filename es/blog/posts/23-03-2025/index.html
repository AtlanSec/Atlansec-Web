
<!doctype html>
<html lang="es" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="https://atlansec.es/es/blog/posts/23-03-2025/">
      
      
      
      
      <link rel="icon" href="../../../../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.4">
    
    
      
        <title>Server-Side Request Forgery: La Puerta Trasera que Puede Derribar tu Infraestructura - Atlansec</title>
      
    
    
      <link rel="stylesheet" href="../../../../assets/stylesheets/main.8608ea7d.min.css">
      
        
        <link rel="stylesheet" href="../../../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../../../stylesheets/extra.css">
    
    <script>__md_scope=new URL("../../../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
      
        <meta  property="og:type"  content="website" >
      
        <meta  property="og:title"  content="Server-Side Request Forgery: La Puerta Trasera que Puede Derribar tu Infraestructura - Atlansec" >
      
        <meta  property="og:description"  content="None" >
      
        <meta  property="og:image"  content="https://atlansec.es/assets/images/social/es/blog/posts/23-03-2025.png" >
      
        <meta  property="og:image:type"  content="image/png" >
      
        <meta  property="og:image:width"  content="1200" >
      
        <meta  property="og:image:height"  content="630" >
      
        <meta  property="og:url"  content="https://atlansec.es/es/blog/posts/23-03-2025/" >
      
        <meta  name="twitter:card"  content="summary_large_image" >
      
        <meta  name="twitter:title"  content="Server-Side Request Forgery: La Puerta Trasera que Puede Derribar tu Infraestructura - Atlansec" >
      
        <meta  name="twitter:description"  content="None" >
      
        <meta  name="twitter:image"  content="https://atlansec.es/assets/images/social/es/blog/posts/23-03-2025.png" >
      
    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="white" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#server-side-request-forgery-la-puerta-trasera-que-puede-derribar-tu-infraestructura" class="md-skip">
          Saltar a contenido
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      <!--
  Copyright (c) 2016-2024 Martin Donath <martin.donath@squidfunk.com>

  Permission is hereby granted, free of charge, to any person obtaining a copy
  of this software and associated documentation files (the "Software"), to
  deal in the Software without restriction, including without limitation the
  rights to use, copy, modify, merge, publish, distribute, sublicense, and/or
  sell copies of the Software, and to permit persons to whom the Software is
  furnished to do so, subject to the following conditions:

  The above copyright notice and this permission notice shall be included in
  all copies or substantial portions of the Software.

  THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
  IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
  FITNESS FOR A PARTICULAR PURPOSE AND NON-INFRINGEMENT. IN NO EVENT SHALL THE
  AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
  LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING
  FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS
  IN THE SOFTWARE.
-->

<!-- Determine classes -->
 

<style>
  .md-header {
    box-shadow: none;
  }

  .md-post__back {
    border-bottom: none !important;
  }
</style>

<!-- Header -->
<header class="md-header" data-md-component="header" style="width: 100%">
  <nav class="md-header__inner md-grid" aria-label="Cabecera">
    <!-- Button to open drawer -->
    <label class="md-header__button md-icon" for="__drawer">
       <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>

    <!-- Link to home -->
    <a
      href="../../../"
      title="Atlansec"
      class="md-header__button md-logo"
      aria-label="Atlansec"
      data-md-component="logo"
    >
      
  <img src="../../../../../assets/images/logo.png" alt="logo">

    </a>

    <!-- Color palette toggle -->
      

    <!-- User preference: color palette -->
    

    <!-- Site language selector -->
     <div class="md-header__option">
  <div class="md-select">
    
    <button class="md-header__button md-icon" aria-label="Seleccionar idioma">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m12.87 15.07-2.54-2.51.03-.03A17.5 17.5 0 0 0 14.07 6H17V4h-7V2H8v2H1v2h11.17C11.5 7.92 10.44 9.75 9 11.35 8.07 10.32 7.3 9.19 6.69 8h-2c.73 1.63 1.73 3.17 2.98 4.56l-5.09 5.02L4 19l5-5 3.11 3.11zM18.5 10h-2L12 22h2l1.12-3h4.75L21 22h2zm-2.62 7 1.62-4.33L19.12 17z"/></svg>
    </button>
    <div class="md-select__inner">
      <ul class="md-select__list">
        
          <li class="md-select__item">
            <a href="../../../../blog/posts/23-03-2025/" hreflang="en" class="md-select__link">
              English
            </a>
          </li>
        
          <li class="md-select__item">
            <a href="./" hreflang="es" class="md-select__link">
              Spanish
            </a>
          </li>
        
      </ul>
    </div>
  </div>
</div>  
    <style>
      .md-header__inner,
      .md-grid {
        justify-content: space-between;
      }
      @media screen and (max-width: 1219px) {
        .md-search {
          position: absolute;
          right: 0;
        }
      }
    </style>
    <!-- Button to open search modal -->
    
    <label class="md-header__button md-icon" for="__search">
       <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
    </label>

    <!-- Search interface -->
    <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Búsqueda" placeholder="Búsqueda" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Buscar">
        
          <a href="javascript:void(0)" class="md-search__icon md-icon" title="Compartir" aria-label="Compartir" data-clipboard data-clipboard-text="" data-md-component="search-share" tabindex="-1">
            
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7s-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91s2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08"/></svg>
          </a>
        
        <button type="reset" class="md-search__icon md-icon" title="Limpiar" aria-label="Limpiar" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Inicializando búsqueda
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div> 

    <!-- Repository information -->
     
  </nav>

  <!-- Navigation tabs (sticky) -->
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Pestañas" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../../../" class="md-tabs__link">
        
  
    
  
  Inicio

      </a>
    </li>
  

      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../../../services/" class="md-tabs__link">
        
  
    
  
  Servicios

      </a>
    </li>
  

      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../../" class="md-tabs__link">
        
  
    
  
  Blog

      </a>
    </li>
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navegación" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../../" title="Atlansec" class="md-nav__button md-logo" aria-label="Atlansec" data-md-component="logo">
      
  <img src="../../../../../assets/images/logo.png" alt="logo">

    </a>
    Atlansec
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Inicio
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../services/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Servicios
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Blog
    
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Tabla de contenidos">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Tabla de contenidos
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#que-es-una-vulnerabilidad-ssrf" class="md-nav__link">
    <span class="md-ellipsis">
      ¿Qué es una vulnerabilidad SSRF?
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#impacto-de-los-ataques-ssrf" class="md-nav__link">
    <span class="md-ellipsis">
      Impacto de los ataques SSRF
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#tipos-de-server-side-request-forgery" class="md-nav__link">
    <span class="md-ellipsis">
      Tipos de Server-Side Request Forgery
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Tipos de Server-Side Request Forgery">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#ssrf-estandar" class="md-nav__link">
    <span class="md-ellipsis">
      SSRF Estándar
    </span>
  </a>
  
    <nav class="md-nav" aria-label="SSRF Estándar">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#metodologia-de-explotacion" class="md-nav__link">
    <span class="md-ellipsis">
      Metodología de explotación
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ejemplo-de-explotacion-para-obtener-acceso-a-metadatos-de-amazon-ec2" class="md-nav__link">
    <span class="md-ellipsis">
      Ejemplo de explotación para obtener acceso a metadatos de Amazon EC2
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ejemplo-de-explotacion-para-la-lectura-de-archivos-locales" class="md-nav__link">
    <span class="md-ellipsis">
      Ejemplo de explotación para la lectura de archivos locales:
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ssrf-a-ciegas" class="md-nav__link">
    <span class="md-ellipsis">
      SSRF a ciegas
    </span>
  </a>
  
    <nav class="md-nav" aria-label="SSRF a ciegas">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#metodologia-de-explotacion_1" class="md-nav__link">
    <span class="md-ellipsis">
      Metodología de explotación
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#como-prevenir-los-ataques-ssrf" class="md-nav__link">
    <span class="md-ellipsis">
      Como prevenir los ataques SSRF
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Como prevenir los ataques SSRF">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#validar-estrictamente-la-entrada" class="md-nav__link">
    <span class="md-ellipsis">
      Validar estrictamente la entrada
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#uso-de-web-application-firewalls-wafs" class="md-nav__link">
    <span class="md-ellipsis">
      Uso de Web Application Firewalls (WAFs)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#segmentacion-de-red" class="md-nav__link">
    <span class="md-ellipsis">
      Segmentación de Red
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#implementar-monitorizacion" class="md-nav__link">
    <span class="md-ellipsis">
      Implementar monitorización
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#pruebas-periodicas-de-seguridad" class="md-nav__link">
    <span class="md-ellipsis">
      Pruebas periódicas de seguridad
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#conclusion" class="md-nav__link">
    <span class="md-ellipsis">
      Conclusión
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  <nav class="md-tags" >
    
      
      
      
        <span class="md-tag">Ciberseguridad</span>
      
    
      
      
      
        <span class="md-tag">Pentesting</span>
      
    
      
      
      
        <span class="md-tag">SSRF</span>
      
    
      
      
      
        <span class="md-tag">Seguridad Web</span>
      
    
      
      
      
        <span class="md-tag">Vulnerabilidades</span>
      
    
  </nav>



<h1 id="server-side-request-forgery-la-puerta-trasera-que-puede-derribar-tu-infraestructura">Server-Side Request Forgery: La Puerta Trasera que Puede Derribar tu Infraestructura</h1>
<p>En el ámbito de la seguridad web, las vulnerabilidades <strong>Server-Side Request Forgery (SSRF)</strong> destacan como una de las amenazas más críticas y subestimadas. Permiten a los atacantes manipular servidores para realizar peticiones HTTP no autorizadas a sistemas internos, comprometiendo desde APIs y servicios en la nube hasta infraestructuras protegidas por firewalls.</p>
<p>Esta técnica de ataque, a menudo subestimada, puede transformar un servidor aparentemente seguro en una puerta de entrada para los ciberdelincuentes, permitiéndoles acceder a recursos internos, robar datos sensibles e incluso lanzar ataques contra terceros.</p>
<p>¿El resultado? Robo de datos, acceso a servicios internos, ejecución remota de código y, en última instancia, daño a la reputación, multas por incumplimiento de normativas como GDPR, y pérdidas financieras significativas. Un ataque SSRF exitoso puede paralizar operaciones críticas y comprometer la confianza de los clientes.</p>
<!-- more -->

<h2 id="que-es-una-vulnerabilidad-ssrf">¿Qué es una vulnerabilidad SSRF?</h2>
<p>Las vulnerabilidades de Server-Side Request Forgery (SSRF) se dan cuando un atacante puede manipular un servidor para que realice solicitudes no autorizadas. Imagina que un servidor web actúa como un mensajero que normalmente entrega mensajes (solicitudes) solo a destinatarios autorizados. Pues la explotación de un ataque SSRF sería el equivalente a que un extraño forzara al mensajero a mandar cartas a cualquier destinatario sin filtro, pudiendo mandar mensajes sin pasar por aduana y con remitente oficial.  </p>
<p>Para ver un caso más concreto, consideremos una aplicación de compras que consulta el stock de productos mediante solicitudes a una API REST. La aplicación pasa la URL a consultar al endpoint de la API a través de una solicitud HTTP. Un atacante que notase esto, podría modificar esta URL para acceder a otros endpoints internos de la API, pudiendo llegar a obtener información no autorizada, como datos de otros usuarios.</p>
<p>Además, los ataques SSRF no se limitan al protocolo HTTP. En ciertos casos, un atacante podría intentar usar otros esquemas de URI, como <code>file://</code> para acceder a archivos locales en el servidor, <code>smb://</code> para forzar una autenticación y obtener un hash NTLM u otros protocolos de diversa índole.</p>
<h2 id="impacto-de-los-ataques-ssrf">Impacto de los ataques SSRF</h2>
<p>Por lo general, un ataque SSRF puede resultar en el acceso no autorizado a recursos internos. Además, en algunas situaciones, la vulnerabilidad SSRF podría permitir a un atacante la ejecución de comandos arbitrarios mediante ciertas cadenas de vulnerabilidades.</p>
<p>Cuando un SSRF se puede utilizar para establecer conexiones con sistemas externos de terceros, un atacante puede emplearlo para llevar a cabo ataques de suplantación. Esto significa que los ataques parecerán originarse desde la organización que aloja la aplicación vulnerable. Por ejemplo, un atacante podría aprovechar un servidor con SSRF para escanear puertos en la red interna de otra empresa o incluso lanzar un ataque de denegación de servicio (DoS) contra un servicio externo, haciendo que parezca que la ofensiva proviene de la organización comprometida.</p>
<p>Otro posible escenario de explotación, es la exploración de redes internas (intranet), donde un atacante puede aprovechar el SSRF para enviar solicitudes a direcciones internas a través del servidor afectado. Esto le permitiría identificar puertos abiertos, mapear servicios internos y recopilar información sensible sobre la infraestructura de la red. La gravedad del ataque aumenta si el servidor comprometido posee acceso privilegiado a recursos internos que normalmente estarían protegidos contra accesos externos.</p>
<h2 id="tipos-de-server-side-request-forgery">Tipos de Server-Side Request Forgery</h2>
<p>Existen dos tipos principales de ataques Server-Side Request Forgery (SSRF):</p>
<ul>
<li><strong>SSRF estándar</strong>: En este tipo de ataque, la respuesta del servidor se muestra directamente al atacante. El servidor obtiene la URL solicitada por el atacante y envía el contenido (o parte de él) en la respuesta de vuelta.</li>
<li><strong>SSRF a ciegas (Blind SSRF)</strong>: En este caso, la respuesta no se envía de vuelta al atacante. El atacante debe idear formas de confirmar y explotar la vulnerabilidad sin ver directamente la respuesta del servidor.</li>
</ul>
<p>A continuación, veremos las características y métodos de explotación propios de cada tipo de SSRF. Además de posibles enfoques para la detección y mitigación de estas vulnerabilidades.</p>
<h3 id="ssrf-estandar"><strong>SSRF Estándar</strong></h3>
<p>El ataque de SSRF estándar es la forma más directa de realizar este ataque. En este escenario, el atacante puede observar directamente la respuesta del servidor a la solicitud manipulada. Esto puede permitir al atacante recopilar información detallada sobre la red interna, identificar servicios accesibles y recuperar datos potencialmente sensibles.</p>
<h4 id="metodologia-de-explotacion">Metodología de explotación</h4>
<p>La explotación de este tipo de SSRF se divide en 3 fases:</p>
<ol>
<li><strong>Inyección:</strong> El atacante introduce una URL maliciosa en un campo de entrada de la aplicación.</li>
<li><strong>Solicitud:</strong> El servidor, sin validar la URL, realiza una solicitud al recurso especificado por el atacante.</li>
<li><strong>Revelación:</strong> La respuesta del servidor se devuelve al atacante, permitiéndole acceder a información interna.</li>
</ol>
<p>En el siguiente ejemplo tenemos una aplicación web que permite consultar el stock de los productos que oferta. Para poder ver las peticiones de manera más clara usaremos un proxy de aplicación como es el caso de BurpSuite, así veremos la solicitud que se realiza al consultar el stock de los productos:</p>
<div class="language-http highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="nf">POST</span> <span class="nn">/product/stock</span> <span class="kr">HTTP</span><span class="o">/</span><span class="m">1.0</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="na">Content-Type</span><span class="o">:</span> <span class="l">application/x-www-form-urlencoded</span>
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="na">Content-Length</span><span class="o">:</span> <span class="l">118</span>
</span><span id="__span-0-4"><a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a>
</span><span id="__span-0-5"><a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="nt">stockApi</span><span class="o">=</span><span class="s">stockApi</span><span class="o">=</span><span class="s">http://internal-stock-api/check?productId</span><span class="o">=</span><span class="s">123</span>
</span></code></pre></div>
<p>Esta solicitud hace que el cliente reciba el stock del producto indicado mediante el <code>productId</code>. Sin embargo, un atacante podría modificar la petición a la URL que se especifica, como por ejemplo:</p>
<div class="language-http highlight"><pre><span></span><code><span id="__span-1-1"><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a><span class="nf">POST</span> <span class="nn">/product/stock</span> <span class="kr">HTTP</span><span class="o">/</span><span class="m">1.0</span>
</span><span id="__span-1-2"><a id="__codelineno-1-2" name="__codelineno-1-2" href="#__codelineno-1-2"></a><span class="na">Content-Type</span><span class="o">:</span> <span class="l">application/x-www-form-urlencoded</span>
</span><span id="__span-1-3"><a id="__codelineno-1-3" name="__codelineno-1-3" href="#__codelineno-1-3"></a><span class="na">Content-Length</span><span class="o">:</span> <span class="l">118</span>
</span><span id="__span-1-4"><a id="__codelineno-1-4" name="__codelineno-1-4" href="#__codelineno-1-4"></a>
</span><span id="__span-1-5"><a id="__codelineno-1-5" name="__codelineno-1-5" href="#__codelineno-1-5"></a><span class="nt">stockApi</span><span class="o">=</span><span class="s">http://localhost/admin</span>
</span></code></pre></div>
<p>Al mandar esta solicitud, si existe el directorio <code>/admin</code> en la máquina atacada y es procesada sin más validación, el atacante podría llegar a acceder al panel de administración interno.</p>
<h4 id="ejemplo-de-explotacion-para-obtener-acceso-a-metadatos-de-amazon-ec2">Ejemplo de explotación para obtener acceso a metadatos de Amazon EC2</h4>
<p>Un caso común de explotación de SSRF es en el que al atacante accede a metadatos internos de una instancia de EC2 en AWS:
<div class="language-http highlight"><pre><span></span><code><span id="__span-2-1"><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a><span class="nf">POST</span> <span class="nn">/product/stock</span> <span class="kr">HTTP</span><span class="o">/</span><span class="m">1.0</span>
</span><span id="__span-2-2"><a id="__codelineno-2-2" name="__codelineno-2-2" href="#__codelineno-2-2"></a><span class="na">Content-Type</span><span class="o">:</span> <span class="l">application/x-www-form-urlencoded</span>
</span><span id="__span-2-3"><a id="__codelineno-2-3" name="__codelineno-2-3" href="#__codelineno-2-3"></a><span class="na">Content-Length</span><span class="o">:</span> <span class="l">118</span>
</span><span id="__span-2-4"><a id="__codelineno-2-4" name="__codelineno-2-4" href="#__codelineno-2-4"></a>
</span><span id="__span-2-5"><a id="__codelineno-2-5" name="__codelineno-2-5" href="#__codelineno-2-5"></a><span class="nt">stockApi</span><span class="o">=</span><span class="s">http://169.254.169.254/latest/meta-data/</span>
</span></code></pre></div>
El acceso a esta API podría revelar información sensible como claves de acceso, roles IAM u otra información sensible.</p>
<p>Podemos encontrar contramedidas especificas en la <a href="https://aws.amazon.com/blogs/security/defense-in-depth-open-firewalls-reverse-proxies-ssrf-vulnerabilities-ec2-instance-metadata-service/" target="_blank">documentacion de AWS</a>.</p>
<h4 id="ejemplo-de-explotacion-para-la-lectura-de-archivos-locales">Ejemplo de explotación para la lectura de archivos locales:</h4>
<p>Si la aplicación habilita el uso del esquema <code>file://</code>, un atacante podría intentar leer archivos del sistema de la siguiente manera:</p>
<div class="language-http highlight"><pre><span></span><code><span id="__span-3-1"><a id="__codelineno-3-1" name="__codelineno-3-1" href="#__codelineno-3-1"></a><span class="nf">POST</span> <span class="nn">/product/stock</span> <span class="kr">HTTP</span><span class="o">/</span><span class="m">1.0</span>
</span><span id="__span-3-2"><a id="__codelineno-3-2" name="__codelineno-3-2" href="#__codelineno-3-2"></a><span class="na">Content-Type</span><span class="o">:</span> <span class="l">application/x-www-form-urlencoded</span>
</span><span id="__span-3-3"><a id="__codelineno-3-3" name="__codelineno-3-3" href="#__codelineno-3-3"></a><span class="na">Content-Length</span><span class="o">:</span> <span class="l">118</span>
</span><span id="__span-3-4"><a id="__codelineno-3-4" name="__codelineno-3-4" href="#__codelineno-3-4"></a>
</span><span id="__span-3-5"><a id="__codelineno-3-5" name="__codelineno-3-5" href="#__codelineno-3-5"></a><span class="nt">stockApi</span><span class="o">=</span><span class="s">file:///etc/shadow</span>
</span></code></pre></div>
<h3 id="ssrf-a-ciegas"><strong>SSRF a ciegas</strong></h3>
<p>El caso del ataque SSRF a ciegas representa un desafío mayor, ya que no se recibe la respuesta del servidor directamente, En este tipo de ataque, el atacanted debe inferir el éxito de su intrusión a través de cambios observables en el comportamiento de la aplicación o mediante la interacción con un servidor externo. Un atacante podría usar este tipo de SSRF para abusar de funciones internas que normalmente no están expuestas o para atacar un servicio de terceros.</p>
<h4 id="metodologia-de-explotacion_1">Metodología de explotación</h4>
<p>Imaginemos una aplicación web que permite a los usuarios subir imágenes de perfil. La aplicación verifica que la imagen sea válida haciendo una solicitud a la URL proporcionada, pero no muestra el resultado de esta verificación al usuario.</p>
<p>Una implementación rudimentaria sería la siguiente:</p>
<div class="language-python highlight"><pre><span></span><code><span id="__span-4-1"><a id="__codelineno-4-1" name="__codelineno-4-1" href="#__codelineno-4-1"></a><span class="kn">import</span> <span class="nn">requests</span>
</span><span id="__span-4-2"><a id="__codelineno-4-2" name="__codelineno-4-2" href="#__codelineno-4-2"></a><span class="k">def</span> <span class="nf">verify_image</span><span class="p">(</span><span class="n">url</span><span class="p">):</span>
</span><span id="__span-4-3"><a id="__codelineno-4-3" name="__codelineno-4-3" href="#__codelineno-4-3"></a>  <span class="k">try</span><span class="p">:</span>
</span><span id="__span-4-4"><a id="__codelineno-4-4" name="__codelineno-4-4" href="#__codelineno-4-4"></a>    <span class="n">response</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
</span><span id="__span-4-5"><a id="__codelineno-4-5" name="__codelineno-4-5" href="#__codelineno-4-5"></a>    <span class="k">if</span> <span class="n">response</span><span class="o">.</span><span class="n">headers</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s1">&#39;content-type&#39;</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;image/&#39;</span><span class="p">):</span>
</span><span id="__span-4-6"><a id="__codelineno-4-6" name="__codelineno-4-6" href="#__codelineno-4-6"></a>      <span class="k">return</span> <span class="kc">True</span>
</span><span id="__span-4-7"><a id="__codelineno-4-7" name="__codelineno-4-7" href="#__codelineno-4-7"></a>  <span class="k">except</span><span class="p">:</span>
</span><span id="__span-4-8"><a id="__codelineno-4-8" name="__codelineno-4-8" href="#__codelineno-4-8"></a>    <span class="k">pass</span>
</span><span id="__span-4-9"><a id="__codelineno-4-9" name="__codelineno-4-9" href="#__codelineno-4-9"></a>    <span class="k">return</span> <span class="kc">False</span>
</span><span id="__span-4-10"><a id="__codelineno-4-10" name="__codelineno-4-10" href="#__codelineno-4-10"></a>
</span><span id="__span-4-11"><a id="__codelineno-4-11" name="__codelineno-4-11" href="#__codelineno-4-11"></a>  <span class="n">user_provided_url</span> <span class="o">=</span> <span class="s2">&quot;https://example.com/image.jpg&quot;</span>
</span><span id="__span-4-12"><a id="__codelineno-4-12" name="__codelineno-4-12" href="#__codelineno-4-12"></a>  <span class="k">if</span> <span class="n">verify_image</span><span class="p">(</span><span class="n">user_provided_url</span><span class="p">):</span>
</span><span id="__span-4-13"><a id="__codelineno-4-13" name="__codelineno-4-13" href="#__codelineno-4-13"></a>    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Valid image&quot;</span><span class="p">)</span>
</span><span id="__span-4-14"><a id="__codelineno-4-14" name="__codelineno-4-14" href="#__codelineno-4-14"></a>  <span class="k">else</span><span class="p">:</span>
</span><span id="__span-4-15"><a id="__codelineno-4-15" name="__codelineno-4-15" href="#__codelineno-4-15"></a>    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Rejected URL&quot;</span><span class="p">)</span>
</span></code></pre></div>
<p>En este caso, el servidor recibe una URL, en este caso es <code>https://example.com/image.jpg</code> y luego realiza una solicitud HTTP a esa URL para verificar si contiene una imagen. Finalmente, si la URL proporcionada devuelve un recurso, con <strong>Content-Type: image/*</strong> se dará como válida.</p>
<p>El problema radica en que el <strong>servidor confía ciegamente</strong> en las URLs proporcionadas por los usuarios, permitiendo que se realicen solicitudes <em>HTTP</em> arbitrarias.</p>
<p>Si un atacante suministra una URL controlada por él mismo o que apunte a un recurso interno del servidor, como <code>http://internal-server/sensitive-data</code>, el atacante no verá directamente la respuesta del servidor, pero podrá deducir si la solicitud fue exitosa observando ciertos comportamientos:</p>
<ul>
<li><strong>Tiempo de respuesta</strong>: Un recurso interno que tarda más en responder podría indicar que el servidor accedió al recurso.</li>
<li><strong>Mensajes de error</strong>: Diferencias en los errores devueltos por el servidor pueden confirmar la existencia del recurso.</li>
</ul>
<p>Para verificar si se realiza la solicitud a la URL suministrada, se emplean técnicas de <strong>fuera de banda (OOB)</strong>, como el monitoreo de solicitudes DNS o HTTP hacia dominios controlados por el atacante. Por ejemplo, podría ser la siguiente URL <code>http://internal-server.sensitive-data.attacker-domain.com</code>. Aquí, <code>attacker-domain</code> es un dominio controlado por el atacante. Si el servidor vulnerable procesa esta URL, intentará resolver el dominio y realizar una solicitud HTTP hacia él. Esto permite al atacante detectar la actividad monitoreando su propio servidor DNS o web. Esta funcionalidad está integrada mediante el Colaborator en la versión profesional de BurpSuite.</p>
<h2 id="como-prevenir-los-ataques-ssrf">Como prevenir los ataques SSRF</h2>
<p>Como hemos visto anteriormente, este tipo de ataques son particularmente peligrosos facilitando la explotación de recursos internos. Para protegerse contra este tipo de vulnerabilidad, es fundamental implementar una combinación de medidas de seguridad robustas. A continuación, se detallan las estrategias más efectivas:</p>
<h3 id="validar-estrictamente-la-entrada"><strong>Validar estrictamente la entrada</strong></h3>
<p>Para protegernos ante un ataque de SSRF, podemos hacer uso de:</p>
<ul>
<li><strong>Whitelists</strong>: Podemos permitir que el servidor acceda a URLs específicas y que sean confiables para el correcto uso de la aplicación. En lugar de permitir cualquier URL, define una lista blanca de dominios y rutas a las que el servidor puede acceder. Cualquier solicitud que no coincida con esta lista blanca debe ser rechazada. Ejemplo: <code>permitidos = ["api.ejemplo.com/productos", "imagenes.ejemplo.com"]</code>.</li>
<li><strong>Bloqueo de direcciones internas</strong>: Podemos bloquear solicitudes a URLs internas, con el fin de que no se puedan acceder a recursos internos del servidor (<code>localhost</code> o cualquier IP del estilo <code>192.168.x.x</code>). Configura el servidor para rechazar cualquier solicitud a direcciones IP privadas (10.0.0.0/8, 172.16.0.0/12, 192.168.0.0/16) y a <code>localhost</code> (127.0.0.1). Esto previene el acceso no autorizado a recursos internos de la red, impidiendo que un atacante manipule el servidor para acceder a servicios o datos que deberían estar protegidos.</li>
<li><strong>Restringir protocolos</strong>: Podemos bloquear protocolos como <strong>smb://</strong>, <strong>file://</strong>, entre otros. Limitar los protocolos a HTTP(S) reduce la superficie de ataque, evitando que se utilicen otros protocolos potencialmente inseguros para acceder a recursos internos o externos.</li>
</ul>
<h3 id="uso-de-web-application-firewalls-wafs"><strong>Uso de Web Application Firewalls (WAFs)</strong></h3>
<p>Podemos configurar un WAF con reglas específicas puede ayudar a detectar y bloquear patrones sospechosos relacionados con SSRF. Los WAFs pueden actuar como una capa adicional de defensa al monitorear y filtrar el tráfico saliente del servidor. </p>
<h3 id="segmentacion-de-red"><strong>Segmentación de Red</strong></h3>
<p>Podemos dividir la red en segmentos y limitar el acceso entre ellos. Por ejemplo, si el servidor web no debería tener acceso directo a la base de datos, por que hace uso de una API. Entonces, debería limitarse la capacidad de mandar tráfico directamente al servidor de bases de datos. De manera general el host no deberia poder acceder a mas servicios internos de los estrictamente necesarios para su funcionamiento, minimizando la superficie de ataque.Este enfoque debe adaptarse a la situación concreta de cada servicio.</p>
<h3 id="implementar-monitorizacion"><strong>Implementar monitorización</strong></h3>
<p>Aunque el SSRF a ciegas no muestra respuestas directamente al atacante, las técnicas fuera de banda dejan trazas que pueden ayudar a detectar intentos maliciosos. A fin de detectar estas técnicas es crucial configurar la monitorización de las requests DNS emitidas por los servidores de aplicación a fin de identificar solicitudes inesperadas hacia dominios externos.</p>
<h3 id="pruebas-periodicas-de-seguridad"><strong>Pruebas periódicas de seguridad</strong></h3>
<p>Realizar auditorías de seguridad periódicas, para proteger tus aplicativos web contra esta y otras amenazas.</p>
<h2 id="conclusion">Conclusión</h2>
<p>La prevención de ataques SSRF requiere un enfoque de seguridad en capas, combinando validación de entrada, uso de WAFs, actualizaciones regulares, segmentación de red y pruebas de seguridad. Al implementar estas medidas, podemos reducir significativamente el riesgo de que nuestra infraestructura sea comprometida por esta vulnerabilidad. Recuerda que la seguridad es un proceso continuo, y es importante mantenerse actualizado sobre las últimas vulnerabilidades y técnicas de ataque.</p>
<p>Stay safe. Stay smart. Stay secure.</p>
<hr />







  
  






                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <style>
    .footer-bottom {
        padding-top: 1rem;
        padding-bottom: 1rem;
        text-align: center;
        font-size: 0.875rem;
        @media screen and (max-width: 991px) {
        font-size: 2vw;
            
        }
    }
</style>


<footer class="md-footer">
    <div class="footer-bottom">
        <p>&copy; 2025 Atlansec. All rights reserved.</p>
    </div>
    </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "../../../..", "features": ["hide_title", "navigation.indexes", "navigation.tabs", "content.code.copy", "i18n", "search.share"], "search": "../../../../assets/javascripts/workers/search.f8cc74c7.min.js", "translations": {"clipboard.copied": "Copiado al portapapeles", "clipboard.copy": "Copiar al portapapeles", "search.result.more.one": "1 m\u00e1s en esta p\u00e1gina", "search.result.more.other": "# m\u00e1s en esta p\u00e1gina", "search.result.none": "No se encontraron documentos", "search.result.one": "1 documento encontrado", "search.result.other": "# documentos encontrados", "search.result.placeholder": "Teclee para comenzar b\u00fasqueda", "search.result.term.missing": "Falta", "select.version": "Seleccionar versi\u00f3n"}}</script>
    
    
      <script src="../../../../assets/javascripts/bundle.f1b6f286.min.js"></script>
      
        <script src="../../../../javascripts/extra.js"></script>
      
    
  </body>
</html>